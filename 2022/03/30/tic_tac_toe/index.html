<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="How many unique games of Tic-Tac-Toe are there?"><meta name=generator content="Hugo 0.97.3"><title>Tic Tac Toe &#183; Kendra Creates</title><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css><!--[if lte IE 8]><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css><![endif]--><!--[if gt IE 8]><!--><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css><!--<![endif]--><!--[if lte IE 8]><link rel=stylesheet href=https://kpendolino.github.io/KendraCreates/css/side-menu-old-ie.css><![endif]--><!--[if gt IE 8]><!--><link rel=stylesheet href=https://kpendolino.github.io/KendraCreates/css/side-menu.css><!--<![endif]--><link rel=stylesheet href=https://kpendolino.github.io/KendraCreates/css/blackburn.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css><link rel=preconnect href=https://fonts.gstatic.com><link href="https://fonts.googleapis.com/css2?family=Raleway&display=swap" rel=stylesheet type=text/css><script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<link rel=stylesheet href=//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/styles/androidstudio.min.css><script async src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/highlight.min.js></script>
<script>hljs.initHighlightingOnLoad()</script><link rel="shortcut icon" href=https://kpendolino.github.io/KendraCreates/img/favicon.ico type=image/x-icon><link rel=stylesheet href=https://kpendolino.github.io/KendraCreates/css/kendra.css><link rel=stylesheet href=https://kpendolino.github.io/KendraCreates/css/syntax.css></head><body><div id=layout><a href=#menu id=menuLink class=menu-link><span></span></a><div id=menu><a class="pure-menu-heading brand" href=https://kpendolino.github.io/KendraCreates/>Kendra Creates</a><div class=pure-menu><ul class=pure-menu-list><li class=pure-menu-item><a class=pure-menu-link href=https://kpendolino.github.io/KendraCreates/><i class="fa fa-home fa-fw"></i>Home</a></li><li class=pure-menu-item><a class=pure-menu-link href=https://kpendolino.github.io/KendraCreates/post/><i class="fa fa-list fa-fw"></i>Posts</a></li><li class=pure-menu-item><a class=pure-menu-link href=https://kpendolino.github.io/KendraCreates/tags/><i class="fa fa-tags fa-fw"></i>Tags</a></li><li class=pure-menu-item><a class=pure-menu-link href=https://kpendolino.github.io/KendraCreates/about/><i class="fa fa-user fa-fw"></i>&nbsp;About</a></li><li class=pure-menu-item><a class=pure-menu-link href=https://kpendolino.github.io/KendraCreates/cv/><i class="fas fa-award"></i>&nbsp;Curriculum Vitae</a></li><li class=pure-menu-item id=js-toggle><a class=pure-menu-link><i class="fas fa-moon" id=toggle-icon></i>&nbsp; <span id=dark-mode-label>Dark Mode</span></a></li><script>var lightModeIcon="fas fa-sun",darkModeIcon="fas fa-moon",lightModeLabel="Light Mode",darkModeLabel="Dark Mode",body=document.body,switcher=document.getElementById("js-toggle");switcher.addEventListener("click",function(){var e=document.getElementById("toggle-icon"),t=document.getElementById("dark-mode-label");this.classList.toggle("js-toggle--checked"),this.classList.add("js-toggle--focus"),this.classList.contains("js-toggle--checked")?(body.classList.add("dark-mode"),localStorage.setItem("darkMode","true"),t.innerHTML=lightModeLabel,e.className=lightModeIcon):(body.classList.remove("dark-mode"),setTimeout(function(){localStorage.removeItem("darkMode")},100),t.innerHTML=darkModeLabel,e.className=darkModeIcon)}),localStorage.getItem("darkMode")&&(switcher.classList.add("js-toggle--checked"),body.classList.add("dark-mode"),label.innerHTML=lightModeLabel,icon.className=lightModeIcon)</script></ul></div><div class="pure-menu social"><ul class=pure-menu-list><li class=pure-menu-item><a class=pure-menu-link href=https://twitter.com/kpendolino rel=me target=_blank><i class="fab fa-twitter-square fa-fw"></i>Twitter</a></li><li class=pure-menu-item><a class=pure-menu-link href=https://linkedin.com/in/kendra-pendolino-a56543a2 rel=me target=_blank><i class="fab fa-linkedin fa-fw"></i>LinkedIn</a></li><li class=pure-menu-item><a class=pure-menu-link href=https://github.com/kpendolino rel=me target=_blank><i class="fab fa-github-square fa-fw"></i>GitHub</a></li></ul></div><div><div class=small-print><small>&copy; Kendra Pendolino 2022</small></div><div class=small-print><small>Built with&nbsp;<a href=https://gohugo.io/ target=_blank>Hugo</a><br></small><small>Based on &nbsp;<a href=https://github.com/yoshiharuyamashita/blackburn target=_blank>Blackburn</a><br></small><small>Customized by &nbsp;<a href=https://github.com/kpendolino>Kendra</a><br></small><small>Cover art <a href=https://prints.larasantaella.es/>Lara Santaella</a></small></div></div></div><div id=main><section id=cover></section><div class=header><h1>Tic Tac Toe</h1><h2>How many unique games of Tic-Tac-Toe are there?</h2></div><div class=content><div class=post-meta><div>✿&nbsp;&nbsp;
<time>Mar 30, 2022</time></div><div><i class="fa fa-tags fa-fw"></i>
<a class=post-taxonomy-tag href=https://kpendolino.github.io/KendraCreates/tags/python>python</a></div></div><p>Have you ever wondered how many unique games of Tic-Tac-Toe there are? This question snuck into my brain the other day and I just had to find out. Come with me and see! My full source code for this exercise, including comments and random debugging notes that I omitted in this post, can be seen at <a href=https://replit.com/@KendraPendolino/TicTacToe>https://replit.com/@KendraPendolino/TicTacToe</a>.</p><p>Before we dive in, I want to talk a little bit about <strong>equivalent boards</strong>. For the purposes of these exercises, I&rsquo;m calling two boards <strong>equivalent</strong> if they:</p><ul><li>Match</li><li>Match after one grid is mirrored (horizontally, vertically, or both)</li><li>Match after one grid is rotated (90°, 180°, or 270°)</li><li>Match after one grid is mirrored <strong>and</strong> rotated</li></ul><p>In short, if you can make the boards look the same by turning your head or playing with mirrors, they&rsquo;re the same for my purposes.</p><h2 id=setup>Setup</h2><p>First, some housekeeping.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>x</span><span class=o>=</span><span class=s2>&#34;X&#34;</span>
</span></span><span class=line><span class=cl><span class=n>o</span><span class=o>=</span><span class=s2>&#34;O&#34;</span>
</span></span><span class=line><span class=cl><span class=n>e</span><span class=o>=</span><span class=s2>&#34;-&#34;</span>
</span></span></code></pre></div><p>This code just sets up a shorthand for the three possible values a space can contain: &ldquo;X&rdquo;, &ldquo;O&rdquo;, or &ldquo;-&rdquo; (<em>e</em> for <em>empty</em>).</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>win</span><span class=o>=</span><span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=n>diag1</span><span class=o>=</span><span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=n>diag2</span><span class=o>=</span><span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>a</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>3</span><span class=p>):</span>
</span></span><span class=line><span class=cl>  <span class=n>win</span><span class=o>.</span><span class=n>append</span><span class=p>([[</span><span class=n>a</span><span class=p>,</span><span class=n>j</span><span class=p>]</span> <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>3</span><span class=p>)])</span> <span class=c1>#cols</span>
</span></span><span class=line><span class=cl>  <span class=n>win</span><span class=o>.</span><span class=n>append</span><span class=p>([[</span><span class=n>i</span><span class=p>,</span><span class=n>a</span><span class=p>]</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>3</span><span class=p>)])</span> <span class=c1>#rows</span>
</span></span><span class=line><span class=cl>  <span class=n>diag1</span><span class=o>.</span><span class=n>append</span><span class=p>([</span><span class=n>a</span><span class=p>,</span><span class=n>a</span><span class=p>])</span>
</span></span><span class=line><span class=cl>  <span class=n>diag2</span><span class=o>.</span><span class=n>append</span><span class=p>([</span><span class=n>a</span><span class=p>,</span><span class=mi>2</span><span class=o>-</span><span class=n>a</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>win</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>diag1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>win</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>diag2</span><span class=p>)</span>
</span></span></code></pre></div><p>This code defines the combinations of cells that can trigger a victory, e.g. each row, column, and diagonal.</p><h2 id=defining-the-board>Defining The Board</h2><p>I decided to set up a <code>Board</code> class to wrangle storing, formatting, and printing data, calculating equivalent grids, determining valid moves, and checking whether the game is won.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>Board</span><span class=p>():</span>
</span></span><span class=line><span class=cl>  <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>board</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span><span class=nb>hash</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=nb>hash</span><span class=o>==</span><span class=kc>None</span><span class=p>:</span> 
</span></span><span class=line><span class=cl>      <span class=n>lines</span><span class=o>=</span><span class=p>[</span><span class=nb>hash</span><span class=p>[</span><span class=mi>0</span><span class=p>:</span><span class=mi>3</span><span class=p>],</span><span class=nb>hash</span><span class=p>[</span><span class=mi>4</span><span class=p>:</span><span class=mi>7</span><span class=p>],</span><span class=nb>hash</span><span class=p>[</span><span class=mi>8</span><span class=p>:</span><span class=mi>12</span><span class=p>]]</span>
</span></span><span class=line><span class=cl>      <span class=bp>self</span><span class=o>.</span><span class=n>b</span> <span class=o>=</span> <span class=p>[[</span><span class=n>c</span> <span class=k>for</span> <span class=n>c</span> <span class=ow>in</span> <span class=n>line</span><span class=p>]</span> <span class=k>for</span> <span class=n>line</span> <span class=ow>in</span> <span class=n>lines</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=ow>not</span> <span class=n>board</span><span class=o>==</span><span class=kc>None</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>b</span> <span class=o>=</span> <span class=n>board</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>b</span> <span class=o>=</span> <span class=p>[[</span><span class=n>e</span> <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>3</span><span class=p>)]</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>3</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>  <span class=o>...</span>
</span></span></code></pre></div><p>In the init method, I handle setting up the board. If <code>board</code> and <code>hash</code> are both omitted, it sets up a blank board in <code>self.e</code>, with a 3x3 array containing <code>e</code> in each cell. If <code>board</code> is provided, it is saved as <code>self.b</code>. I also added support for initializing a board from a <code>hash</code>. This is just a representation of a board as a string, like <span style=white-space:nowrap><code>"XO-,---,-OX"</code></style>. You&rsquo;ll see why I added this a little later.</p><blockquote><p>Note: This is code that I wrote for myself for exploration - it doesn&rsquo;t include the kind of validation and error checking that you&rsquo;d want if you were going to make this class public. For instance, I don&rsquo;t check that <code>board</code> is a 3x3 array that contains only &ldquo;X&rdquo;, &ldquo;O&rdquo;, or &ldquo;e&rdquo;.</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>Board</span><span class=p>():</span>
</span></span><span class=line><span class=cl>  <span class=o>...</span>
</span></span><span class=line><span class=cl>  <span class=k>def</span> <span class=nf>hash</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=s2>&#34;</span><span class=si>%s</span><span class=s2>,</span><span class=si>%s</span><span class=s2>,</span><span class=si>%s</span><span class=s2>&#34;</span><span class=o>%</span><span class=p>(</span><span class=s2>&#34;&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>([</span><span class=bp>self</span><span class=o>.</span><span class=n>b</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>3</span><span class=p>)]),</span>
</span></span><span class=line><span class=cl>                       <span class=s2>&#34;&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>([</span><span class=bp>self</span><span class=o>.</span><span class=n>b</span><span class=p>[</span><span class=mi>1</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>3</span><span class=p>)]),</span>
</span></span><span class=line><span class=cl>                       <span class=s2>&#34;&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>([</span><span class=bp>self</span><span class=o>.</span><span class=n>b</span><span class=p>[</span><span class=mi>2</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>3</span><span class=p>)]),</span> 
</span></span><span class=line><span class=cl>                       <span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=k>def</span> <span class=nf>copy</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>Board</span><span class=p>(</span><span class=n>board</span><span class=o>=</span><span class=p>[[</span><span class=bp>self</span><span class=o>.</span><span class=n>b</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>3</span><span class=p>)]</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>3</span><span class=p>)])</span>
</span></span><span class=line><span class=cl>  <span class=o>...</span>
</span></span></code></pre></div><p>In this section, I added two utility methods: <code>hash</code> to return a representation of the grid as a string - this can be fed back into the Board constructor to generate a new board - and <code>copy</code> to make a clone of a board.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>Board</span><span class=p>():</span>
</span></span><span class=line><span class=cl>  <span class=o>...</span>
</span></span><span class=line><span class=cl>  <span class=k>def</span> <span class=nf>flip</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span><span class=n>flip</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>flip</span><span class=o>==</span><span class=s2>&#34;&#34;</span><span class=p>:</span> <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>b</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>flip</span><span class=o>==</span><span class=s2>&#34;H&#34;</span><span class=p>:</span> <span class=k>return</span> <span class=p>[[</span><span class=bp>self</span><span class=o>.</span><span class=n>b</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=mi>2</span><span class=o>-</span><span class=n>j</span><span class=p>]</span> <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>3</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>                          <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span> <span class=p>(</span><span class=mi>3</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>flip</span><span class=o>==</span><span class=s2>&#34;V&#34;</span><span class=p>:</span> <span class=k>return</span> <span class=p>[[</span><span class=bp>self</span><span class=o>.</span><span class=n>b</span><span class=p>[</span><span class=mi>2</span><span class=o>-</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>3</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>                          <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span> <span class=p>(</span><span class=mi>3</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>flip</span> <span class=ow>in</span> <span class=p>[</span><span class=s2>&#34;HV&#34;</span><span class=p>,</span><span class=s2>&#34;VH&#34;</span><span class=p>]:</span> <span class=k>return</span> <span class=p>[[</span><span class=bp>self</span><span class=o>.</span><span class=n>b</span><span class=p>[</span><span class=mi>2</span><span class=o>-</span><span class=n>i</span><span class=p>][</span><span class=mi>2</span><span class=o>-</span><span class=n>j</span><span class=p>]</span> <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span> <span class=p>(</span><span class=mi>3</span><span class=p>)]</span> 
</span></span><span class=line><span class=cl>                                    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span> <span class=p>(</span><span class=mi>3</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>  <span class=k>def</span> <span class=nf>rot</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span><span class=n>rot</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>rot</span><span class=o>==</span><span class=s2>&#34;&#34;</span><span class=p>:</span> <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>b</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>rot</span><span class=o>==</span><span class=s2>&#34;CW&#34;</span><span class=p>:</span> <span class=k>return</span> <span class=p>[[</span><span class=bp>self</span><span class=o>.</span><span class=n>b</span><span class=p>[</span><span class=mi>2</span><span class=o>-</span><span class=n>j</span><span class=p>][</span><span class=n>i</span><span class=p>]</span> <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span> <span class=p>(</span><span class=mi>3</span><span class=p>)]</span> 
</span></span><span class=line><span class=cl>                          <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span> <span class=p>(</span><span class=mi>3</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>rot</span><span class=o>==</span><span class=s2>&#34;CCW&#34;</span><span class=p>:</span> <span class=k>return</span> <span class=p>[[</span><span class=bp>self</span><span class=o>.</span><span class=n>b</span><span class=p>[</span><span class=n>j</span><span class=p>][</span><span class=mi>2</span><span class=o>-</span><span class=n>i</span><span class=p>]</span> <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span> <span class=p>(</span><span class=mi>3</span><span class=p>)]</span> 
</span></span><span class=line><span class=cl>                           <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span> <span class=p>(</span><span class=mi>3</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>rot</span><span class=o>==</span><span class=s2>&#34;180&#34;</span><span class=p>:</span> <span class=k>return</span> <span class=p>[[</span><span class=bp>self</span><span class=o>.</span><span class=n>b</span><span class=p>[</span><span class=mi>2</span><span class=o>-</span><span class=n>j</span><span class=p>][</span><span class=mi>2</span><span class=o>-</span><span class=n>i</span><span class=p>]</span> <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span> <span class=p>(</span><span class=mi>3</span><span class=p>)]</span> 
</span></span><span class=line><span class=cl>                           <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span> <span class=p>(</span><span class=mi>3</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>  <span class=o>...</span>
</span></span></code></pre></div><p>Here, I&rsquo;ve added code to generate equivalent versions of the same board - these return what the grid would look like if it were flipped (vertically, horizontally, or both) or rotated (clockwise, counterclockwise, or 180 degrees). These will come into play when I&rsquo;m checking to make sure I&rsquo;m not retracing my steps or duplicating effort.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>Board</span><span class=p>():</span>
</span></span><span class=line><span class=cl>  <span class=o>...</span>
</span></span><span class=line><span class=cl>  <span class=k>def</span> <span class=nf>pr</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span><span class=n>label</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>label</span><span class=p>:</span> <span class=nb>print</span><span class=p>(</span><span class=n>label</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>3</span><span class=p>):</span>
</span></span><span class=line><span class=cl>      <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>b</span><span class=p>[</span><span class=n>i</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=o>...</span>
</span></span></code></pre></div><p>Up next, a method to print out the board in a readable grid, with an optional label for clarity. I used this a lot when I was testing the code to generate flips and rotations and the code to test whether two boards are equivalent.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>Board</span><span class=p>():</span>
</span></span><span class=line><span class=cl>  <span class=o>...</span>
</span></span><span class=line><span class=cl>  <span class=k>def</span> <span class=nf>getEqHashes</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>hashes</span><span class=o>=</span><span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>b_rot</span> <span class=ow>in</span> <span class=p>[</span><span class=s2>&#34;&#34;</span><span class=p>,</span><span class=s2>&#34;CW&#34;</span><span class=p>,</span><span class=s2>&#34;CCW&#34;</span><span class=p>,</span><span class=s2>&#34;180&#34;</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>      <span class=n>r</span> <span class=o>=</span> <span class=n>Board</span><span class=p>(</span><span class=n>board</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>rot</span><span class=p>(</span><span class=n>b_rot</span><span class=p>))</span>
</span></span><span class=line><span class=cl>      <span class=k>for</span> <span class=n>b_flip</span> <span class=ow>in</span> <span class=p>[</span><span class=s2>&#34;&#34;</span><span class=p>,</span><span class=s2>&#34;H&#34;</span><span class=p>,</span><span class=s2>&#34;V&#34;</span><span class=p>,</span><span class=s2>&#34;VH&#34;</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=n>f</span><span class=o>=</span> <span class=n>Board</span><span class=p>(</span><span class=n>board</span><span class=o>=</span><span class=n>r</span><span class=o>.</span><span class=n>flip</span><span class=p>(</span><span class=n>b_flip</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=n>hashes</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>f</span><span class=o>.</span><span class=n>hash</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>hashes</span> 
</span></span><span class=line><span class=cl>  <span class=o>...</span>
</span></span></code></pre></div><p>This little fella returns a list of hashes of all boards that are equivalent to this board.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>Board</span><span class=p>():</span>
</span></span><span class=line><span class=cl>  <span class=o>...</span>
</span></span><span class=line><span class=cl>  <span class=k>def</span> <span class=nf>eqhash</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>bd2hash</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>equivalent</span><span class=p>(</span><span class=n>Board</span><span class=p>(</span><span class=nb>hash</span><span class=o>=</span><span class=n>bd2hash</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=k>def</span> <span class=nf>equivalent</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>bd2</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=bp>self</span><span class=o>.</span><span class=n>pr</span><span class=p>(</span><span class=s2>&#34;Board 1&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>bd2</span><span class=o>.</span><span class=n>pr</span><span class=p>(</span><span class=s2>&#34;Board 2&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>b</span><span class=o>==</span><span class=n>bd2</span><span class=o>.</span><span class=n>b</span><span class=p>:</span> <span class=k>return</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>b_rot</span> <span class=ow>in</span> <span class=p>[</span><span class=s2>&#34;&#34;</span><span class=p>,</span><span class=s2>&#34;CW&#34;</span><span class=p>,</span><span class=s2>&#34;CCW&#34;</span><span class=p>,</span><span class=s2>&#34;180&#34;</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>      <span class=n>r</span> <span class=o>=</span> <span class=n>Board</span><span class=p>(</span><span class=n>bd2</span><span class=o>.</span><span class=n>rot</span><span class=p>(</span><span class=n>b_rot</span><span class=p>))</span>
</span></span><span class=line><span class=cl>      <span class=k>for</span> <span class=n>b_flip</span> <span class=ow>in</span> <span class=p>[</span><span class=s2>&#34;&#34;</span><span class=p>,</span><span class=s2>&#34;H&#34;</span><span class=p>,</span><span class=s2>&#34;V&#34;</span><span class=p>,</span><span class=s2>&#34;VH&#34;</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=n>f</span><span class=o>=</span><span class=n>r</span><span class=o>.</span><span class=n>flip</span><span class=p>(</span><span class=n>b_flip</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>b</span><span class=o>==</span><span class=n>f</span><span class=p>:</span> 
</span></span><span class=line><span class=cl>          <span class=c1>#self.pr(&#34;Board 1&#34;)</span>
</span></span><span class=line><span class=cl>          <span class=c1>#bd2.pr(&#34;Board 2&#34;)</span>
</span></span><span class=line><span class=cl>          <span class=c1>#r.pr(&#34;Board 2, rotated %s&#34;%b_rot)</span>
</span></span><span class=line><span class=cl>          <span class=c1>#Board(f).pr(&#34;Board 2, rotated %s and flipped %s&#34;%(b_rot,b_flip))</span>
</span></span><span class=line><span class=cl>          <span class=k>return</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>  <span class=o>...</span>
</span></span></code></pre></div><p>These two are friends! The <code>equivalent(bd2)</code> method tells you whether the current board (<code>self</code>) and the board provided as <code>bd2</code> are equivalent. <code>equivalent(bd2hash)</code> does the same thing, but takes a hash instead of a <code>Board</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>Board</span><span class=p>():</span>
</span></span><span class=line><span class=cl>  <span class=o>...</span>
</span></span><span class=line><span class=cl>  <span class=k>def</span> <span class=nf>unclaimed</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>[[</span><span class=n>i</span><span class=p>,</span><span class=n>j</span><span class=p>]</span> <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>3</span><span class=p>)</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>3</span><span class=p>)</span> <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>b</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span><span class=o>==</span><span class=n>e</span> <span class=p>]</span>
</span></span><span class=line><span class=cl>  <span class=k>def</span> <span class=nf>move</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span><span class=n>player</span><span class=p>,</span><span class=n>i</span><span class=p>,</span><span class=n>j</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># returns [board after this move (Board), </span>
</span></span><span class=line><span class=cl>    <span class=c1>#          isGameOver (boolean), </span>
</span></span><span class=line><span class=cl>    <span class=c1>#          [isGameVictory (boolean)]]</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>b</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span><span class=o>!=</span><span class=n>e</span><span class=p>:</span> <span class=k>return</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>    <span class=bp>self</span><span class=o>.</span><span class=n>b</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span><span class=o>=</span><span class=n>player</span>
</span></span><span class=line><span class=cl>    <span class=c1>#check if win condition met</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>w</span> <span class=ow>in</span> <span class=n>win</span><span class=p>:</span>
</span></span><span class=line><span class=cl>      <span class=n>thisw</span><span class=o>=</span><span class=kc>True</span>
</span></span><span class=line><span class=cl>      <span class=k>for</span> <span class=n>c</span> <span class=ow>in</span> <span class=n>w</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>b</span><span class=p>[</span><span class=n>c</span><span class=p>[</span><span class=mi>0</span><span class=p>]][</span><span class=n>c</span><span class=p>[</span><span class=mi>1</span><span class=p>]]</span><span class=o>!=</span><span class=n>player</span><span class=p>:</span> 
</span></span><span class=line><span class=cl>          <span class=n>thisw</span><span class=o>=</span><span class=kc>False</span>
</span></span><span class=line><span class=cl>          <span class=k>break</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=n>thisw</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>[</span><span class=bp>self</span><span class=p>,</span><span class=kc>True</span><span class=p>,</span><span class=kc>True</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>unclaimed</span><span class=p>())</span><span class=o>==</span><span class=mi>0</span><span class=p>:</span> <span class=k>return</span> <span class=p>[</span><span class=bp>self</span><span class=p>,</span><span class=kc>True</span><span class=p>,</span><span class=kc>False</span><span class=p>]</span> <span class=c1># it&#39;s a draw</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>[</span><span class=bp>self</span><span class=p>,</span><span class=kc>False</span><span class=p>]</span>
</span></span><span class=line><span class=cl>  <span class=o>...</span>
</span></span></code></pre></div><p>The <code>unclaimed()</code> method just serves up a list of possible moves (<code>i</code>, <code>j</code> coordinates) that aren&rsquo;t yet taken. I use this with <code>move(player,i,j)</code> to explore all possible outcomes of the games. Since I only try moves in the <code>unclaimed</code> list, there shouldn&rsquo;t ever be an illegal move, but I do have this method return <code>False</code> in case that does happen. If the move doesn&rsquo;t end the game, this will return a list like <code>[Board, False]</code>. If the move ends the game, it will look like <code>[Board, True, (boolean)]</code>, where the last boolean value indicates whether it&rsquo;s a victory (<code>True</code>) or a tie (<code>False</code>).</p><p>Last but not least, I added two stand-alone functions to help view the output in a human-friendly way.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>writeandprint</span><span class=p>(</span><span class=n>out</span><span class=o>=</span><span class=s2>&#34;&#34;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>  <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s2>&#34;summary.txt&#34;</span><span class=p>,</span><span class=s2>&#34;a&#34;</span><span class=p>)</span> <span class=k>as</span> <span class=n>file</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>file</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>out</span><span class=o>+</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>)</span>  
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>out</span><span class=p>)</span>  
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>printFinished</span><span class=p>(</span><span class=n>finished</span><span class=p>,</span><span class=n>label</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=n>label</span><span class=p>:</span> <span class=n>writeandprint</span><span class=p>(</span><span class=s2>&#34;There are </span><span class=si>%d</span><span class=s2> distinct </span><span class=si>%s</span><span class=s2> boards&#34;</span><span class=o>%</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>finished</span><span class=p>),</span><span class=n>label</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=k>else</span><span class=p>:</span> <span class=n>writeandprint</span><span class=p>(</span><span class=s2>&#34;There are </span><span class=si>%d</span><span class=s2> distinct boards&#34;</span><span class=o>%</span><span class=nb>len</span><span class=p>(</span><span class=n>finished</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=n>fin</span><span class=o>=</span><span class=nb>list</span><span class=p>(</span><span class=n>finished</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>fin</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>    <span class=n>b_x</span><span class=o>=</span><span class=n>Board</span><span class=p>(</span><span class=nb>hash</span><span class=o>=</span><span class=n>fin</span><span class=p>[</span><span class=n>x</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=n>b_hashes</span><span class=o>=</span><span class=n>b_x</span><span class=o>.</span><span class=n>getEqHashes</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>y</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>x</span><span class=o>+</span><span class=mi>1</span><span class=p>,</span><span class=nb>len</span><span class=p>(</span><span class=n>fin</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=n>fin</span><span class=p>[</span><span class=n>y</span><span class=p>]</span> <span class=ow>in</span> <span class=n>b_hashes</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>input</span><span class=p>(</span><span class=s2>&#34;duplicate boards: </span><span class=si>%s</span><span class=s2> and </span><span class=si>%s</span><span class=s2>&#34;</span><span class=o>%</span><span class=p>(</span><span class=n>fin</span><span class=p>[</span><span class=n>x</span><span class=p>],</span><span class=n>fin</span><span class=p>[</span><span class=n>y</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=n>bds</span> <span class=ow>in</span> <span class=p>[</span><span class=n>fin</span><span class=p>[</span><span class=mi>5</span><span class=o>*</span><span class=n>a</span><span class=p>:</span><span class=mi>5</span><span class=o>*</span><span class=n>a</span><span class=o>+</span><span class=mi>5</span><span class=p>]</span> <span class=k>for</span> <span class=n>a</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>fin</span><span class=p>)</span><span class=o>//</span><span class=mi>5</span><span class=p>)]:</span>
</span></span><span class=line><span class=cl>    <span class=c1>#print(bds)</span>
</span></span><span class=line><span class=cl>    <span class=n>writeandprint</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\t\t</span><span class=s2>&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>([</span><span class=n>bds</span><span class=p>[</span><span class=n>a</span><span class=p>][:</span><span class=mi>3</span><span class=p>]</span> <span class=k>for</span> <span class=n>a</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>5</span><span class=p>)]))</span>
</span></span><span class=line><span class=cl>    <span class=n>writeandprint</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\t\t</span><span class=s2>&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>([</span><span class=n>bds</span><span class=p>[</span><span class=n>a</span><span class=p>][</span><span class=mi>4</span><span class=p>:</span><span class=mi>7</span><span class=p>]</span> <span class=k>for</span> <span class=n>a</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>5</span><span class=p>)]))</span>
</span></span><span class=line><span class=cl>    <span class=n>writeandprint</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\t\t</span><span class=s2>&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>([</span><span class=n>bds</span><span class=p>[</span><span class=n>a</span><span class=p>][</span><span class=mi>8</span><span class=p>:</span><span class=mi>11</span><span class=p>]</span> <span class=k>for</span> <span class=n>a</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>5</span><span class=p>)]))</span>
</span></span><span class=line><span class=cl>    <span class=n>writeandprint</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>fin</span><span class=p>)</span><span class=o>/</span><span class=mi>5</span><span class=o>&gt;</span><span class=nb>len</span><span class=p>(</span><span class=n>fin</span><span class=p>)</span><span class=o>//</span><span class=mi>5</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>bds</span><span class=o>=</span><span class=n>fin</span><span class=p>[</span><span class=mi>5</span><span class=o>*</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>fin</span><span class=p>)</span><span class=o>//</span><span class=mi>5</span><span class=p>):</span><span class=nb>len</span><span class=p>(</span><span class=n>fin</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>    <span class=n>writeandprint</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\t\t</span><span class=s2>&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>([</span><span class=n>bds</span><span class=p>[</span><span class=n>a</span><span class=p>][:</span><span class=mi>3</span><span class=p>]</span> <span class=k>for</span> <span class=n>a</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>bds</span><span class=p>))]))</span>
</span></span><span class=line><span class=cl>    <span class=n>writeandprint</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\t\t</span><span class=s2>&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>([</span><span class=n>bds</span><span class=p>[</span><span class=n>a</span><span class=p>][</span><span class=mi>4</span><span class=p>:</span><span class=mi>7</span><span class=p>]</span> <span class=k>for</span> <span class=n>a</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>bds</span><span class=p>))]))</span>
</span></span><span class=line><span class=cl>    <span class=n>writeandprint</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\t\t</span><span class=s2>&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>([</span><span class=n>bds</span><span class=p>[</span><span class=n>a</span><span class=p>][</span><span class=mi>8</span><span class=p>:</span><span class=mi>11</span><span class=p>]</span> <span class=k>for</span> <span class=n>a</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>bds</span><span class=p>))]))</span>
</span></span><span class=line><span class=cl>    <span class=n>writeandprint</span><span class=p>()</span>
</span></span></code></pre></div><p>I added <code>writeandprint()</code> because I wanted to save the output to a file <em>and</em> see it in the console output. Last but not least, <code>printFinished(finished,label)</code> goes through the boards in the <code>finished</code> set and prints them out five at a time.</p><p>Now we&rsquo;re ready to get rolling!</p><h2 id=exploring-all-possible-moves>Exploring All Possible Moves</h2><p>I use a recursive function to explore all possible moves from a given point. Here&rsquo;s some basic setup before we dive in there:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>turns</span><span class=o>=</span><span class=p>{}</span>
</span></span><span class=line><span class=cl><span class=n>finished</span><span class=o>=</span><span class=nb>set</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>wins</span><span class=o>=</span><span class=nb>set</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>ties</span><span class=o>=</span><span class=nb>set</span><span class=p>()</span>
</span></span></code></pre></div><p>Just setting up a way to track the possible turns we&rsquo;ve seen (e.g. what can the board look like after 1 turn? After 3? After 6?). Now for the juicy bit.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>allMoves</span><span class=p>(</span><span class=n>board</span><span class=p>,</span><span class=n>turn</span><span class=p>):</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=ow>not</span> <span class=n>turn</span> <span class=ow>in</span> <span class=n>turns</span><span class=p>:</span> <span class=n>turns</span><span class=p>[</span><span class=n>turn</span><span class=p>]</span><span class=o>=</span><span class=nb>set</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=n>turn</span><span class=o>%</span><span class=mi>2</span><span class=o>==</span><span class=mi>0</span><span class=p>:</span> <span class=n>player</span><span class=o>=</span><span class=n>o</span>
</span></span><span class=line><span class=cl>  <span class=k>else</span><span class=p>:</span> <span class=n>player</span><span class=o>=</span><span class=n>x</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>opts</span><span class=o>=</span><span class=n>board</span><span class=o>.</span><span class=n>unclaimed</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=n>opt</span> <span class=ow>in</span> <span class=n>opts</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>next</span> <span class=o>=</span> <span class=n>board</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span><span class=o>.</span><span class=n>move</span><span class=p>(</span><span class=n>player</span><span class=p>,</span><span class=n>opt</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=n>opt</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nb>next</span><span class=o>==</span><span class=kc>False</span><span class=p>:</span> 
</span></span><span class=line><span class=cl>      <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;illegal move: &#34;</span><span class=p>,</span><span class=s2>&#34;</span><span class=si>%s</span><span class=s2>,</span><span class=si>%s</span><span class=s2>,</span><span class=si>%s</span><span class=s2> + </span><span class=si>%s</span><span class=s2> @ (</span><span class=si>%d</span><span class=s2>,</span><span class=si>%d</span><span class=s2>)&#34;</span> <span class=o>%</span> 
</span></span><span class=line><span class=cl>               <span class=p>(</span><span class=n>board</span><span class=o>.</span><span class=n>b</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=n>board</span><span class=o>.</span><span class=n>b</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span><span class=n>board</span><span class=o>.</span><span class=n>b</span><span class=p>[</span><span class=mi>2</span><span class=p>],</span><span class=n>player</span><span class=p>,</span><span class=n>opt</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=n>opt</span><span class=p>[</span><span class=mi>1</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>      <span class=k>continue</span>
</span></span><span class=line><span class=cl>    <span class=n>hashes</span><span class=o>=</span><span class=nb>next</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>getEqHashes</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>alreadyseen</span><span class=o>=</span><span class=kc>False</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=nb>hash</span> <span class=ow>in</span> <span class=n>hashes</span><span class=p>:</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=nb>hash</span> <span class=ow>in</span> <span class=n>turns</span><span class=p>[</span><span class=n>turn</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl>        <span class=n>alreadyseen</span><span class=o>=</span><span class=kc>True</span>
</span></span><span class=line><span class=cl>        <span class=k>break</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>alreadyseen</span><span class=p>:</span> <span class=k>continue</span>
</span></span><span class=line><span class=cl>    <span class=nb>hash</span><span class=o>=</span><span class=nb>next</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>hash</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>turns</span><span class=p>[</span><span class=n>turn</span><span class=p>]</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=nb>hash</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nb>next</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>==</span><span class=kc>True</span><span class=p>:</span> <span class=c1>#game over</span>
</span></span><span class=line><span class=cl>      <span class=n>finished</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=nb>hash</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=nb>next</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=o>==</span><span class=kc>True</span><span class=p>:</span> <span class=n>wins</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=nb>hash</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=k>elif</span> <span class=nb>next</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=o>==</span><span class=kc>False</span><span class=p>:</span> <span class=n>ties</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=nb>hash</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span> <span class=c1>#keep playing</span>
</span></span><span class=line><span class=cl>      <span class=n>allMoves</span><span class=p>(</span><span class=nb>next</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=n>turn</span><span class=o>+</span><span class=mi>1</span><span class=p>)</span>
</span></span></code></pre></div><p>This function calls itself over and over again until the game ends. Each time, it plays out a different scenario for the next move - by the time the first call to <code>allMoves</code> finishes, every possible scenario has been played.</p><p>First, I do a little housekeeping - setting up <code>turns[turn]</code> if it&rsquo;s not already there. I&rsquo;m using <code>set()</code> because I don&rsquo;t want to store duplicates - unique hashes only, please! Incidentally, this is why I created the <code>Board.hash()</code> method - I couldn&rsquo;t add the 3 x 3 arrays to these sets since Python can&rsquo;t hash lists, so I created my own hash function for this purpose.</p><p>Next, I figure out whose turn it is (&ldquo;X&rdquo; or &ldquo;O&rdquo;), then it&rsquo;s time to get all possible options (<code>opts</code>) for the next move by checking <code>board.unclaimed()</code>. This is how I fork the function to see all possibilities. I loop through this list, cloning the board for each iteration and having the current player make their move in the indicated space. Just in case there&rsquo;s a bug in my code, I continue to the next iteration if the move is invalid.</p><blockquote><p>Note: I never did see that &ldquo;illegal move&rdquo; message - it&rsquo;s such a nice feeling when you build in guard rails that you don&rsquo;t end up needing!</p></blockquote><p>Once I&rsquo;ve completed the indicated move, I check through all of the equivalent hashes (e.g hashes of other boards that are functionally identical) and compare them against the moves saved in <code>turns[turn]</code>. If we&rsquo;ve already been here, <code>alreadyseen=True</code> and we can move on to the next move. Otherwise, I get the hash of this move and check whether the game continues or not. If it&rsquo;s game over, I add the hash to <code>finished</code> and either <code>wins</code> or <code>ties</code> depending on how the game ended. If the game continues, I call <code>allMoves</code> again to do the next move.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>allMoves</span><span class=p>(</span><span class=n>blank</span><span class=p>,</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>printFinished</span><span class=p>(</span><span class=n>finished</span><span class=p>,</span><span class=n>label</span><span class=o>=</span><span class=s2>&#34;Finished&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>printFinished</span><span class=p>(</span><span class=n>wins</span><span class=p>,</span><span class=n>label</span><span class=o>=</span><span class=s2>&#34;Wins&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>printFinished</span><span class=p>(</span><span class=n>ties</span><span class=p>,</span><span class=n>label</span><span class=o>=</span><span class=s2>&#34;Ties&#34;</span><span class=p>)</span>
</span></span></code></pre></div><p>The only thing left to do is call <code>allMoves</code> with a blank board for turn 1, and take a look at the output. Here&rsquo;s an excerpt from that output:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>There are 138 distinct Finished boards
</span></span><span class=line><span class=cl>X-O		XXO		O--		OXO		XOO
</span></span><span class=line><span class=cl>O-O		X-X		XXX		XOX		OXX
</span></span><span class=line><span class=cl>XXX		OOO		-O-		OX-		XXO
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>XXX		X-X		X--
</span></span><span class=line><span class=cl>OOX		OOO		XOO
</span></span><span class=line><span class=cl>O--		-X-		X--
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>There are 135 distinct Wins boards
</span></span><span class=line><span class=cl>X-O		XXO		O--		OXO		XXX
</span></span><span class=line><span class=cl>O-O		X-X		XXX		XOX		XO-
</span></span><span class=line><span class=cl>XXX		OOO		-O-		OX-		O-O
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>X-O		XX-		XXX		X-X		X--
</span></span><span class=line><span class=cl>XXO		--X		OOX		OOO		XOO
</span></span><span class=line><span class=cl>OXO		OOO		O--		-X-		X--
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>There are 3 distinct Ties boards
</span></span><span class=line><span class=cl>XOO		XXO		XOX
</span></span><span class=line><span class=cl>OXX		OOX		OOX
</span></span><span class=line><span class=cl>XXO		XXO		XXO
</span></span></code></pre></div><p>You can see the full output here: <a href=https://replit.com/@KendraPendolino/TicTacToe#summary.txt>summary.txt</a>.</p><p>To be extra sure that my results were correct, I used Excel to generate a complete list of all possible grids (filling all 9 positions using any combination of &ldquo;X&rdquo; and &ldquo;O&rdquo;). I filtered these to show only valid grids (5 &ldquo;X&rdquo; and 4 &ldquo;O&rdquo;) that are ties. The result was 16 possible grids - every one of them equivalent to one of the three tie results shown above. Woohoo!</p><h2 id=conclusion>Conclusion</h2><p>It turns out there are 138 <em>functionally different</em> outcomes of Tic-Tac-Toe. There are three ties, which you&rsquo;ve probably seen variations on again <em>and again</em> <strong>and again</strong>. There are 135 ways to win the game, but the vast majority of these are implausible if you&rsquo;re playing with experienced players; however they may show up if you&rsquo;re playing with someone who&rsquo;s just learning the game.</p><p>I hope you&rsquo;ve enjoyed exploring this question with me!</p><h4><i class="fas fa-share-alt" aria-hidden=true></i>&nbsp;Share!</h4><ul class=share-buttons><li><a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fkpendolino.github.io%2fKendraCreates%2f2022%2f03%2f30%2ftic_tac_toe%2f" target=_blank title="Share on Facebook"><i class="fab fa-facebook" aria-hidden=true></i><span class=sr-only>Share on Facebook</span></a></li>&nbsp;&nbsp;&nbsp;<li><a href="https://twitter.com/intent/tweet?source=https%3a%2f%2fkpendolino.github.io%2fKendraCreates%2f2022%2f03%2f30%2ftic_tac_toe%2f" target=_blank title=Tweet><i class="fab fa-twitter" aria-hidden=true></i><span class=sr-only>Tweet</span></a></li>&nbsp;&nbsp;&nbsp;<li><a href="https://plus.google.com/share?url=https%3a%2f%2fkpendolino.github.io%2fKendraCreates%2f2022%2f03%2f30%2ftic_tac_toe%2f" target=_blank title="Share on Google+"><i class="fab fa-google-plus" aria-hidden=true></i><span class=sr-only>Share on Google+</span></a></li>&nbsp;&nbsp;&nbsp;<li><a href="http://www.tumblr.com/share?v=3&u=https%3a%2f%2fkpendolino.github.io%2fKendraCreates%2f2022%2f03%2f30%2ftic_tac_toe%2f" target=_blank title="Post to Tumblr"><i class="fab fa-tumblr" aria-hidden=true></i><span class=sr-only>Post to Tumblr</span></a></li>&nbsp;&nbsp;&nbsp;<li><a href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2fkpendolino.github.io%2fKendraCreates%2f2022%2f03%2f30%2ftic_tac_toe%2f" target=_blank title="Pin it"><i class="fab fa-pinterest-p" aria-hidden=true></i><span class=sr-only>Pin it</span></a></li>&nbsp;&nbsp;&nbsp;<li><a href="http://www.reddit.com/submit?url=https%3a%2f%2fkpendolino.github.io%2fKendraCreates%2f2022%2f03%2f30%2ftic_tac_toe%2f" target=_blank title="Submit to Reddit"><i class="fab fa-reddit-alien" aria-hidden=true></i><span class=sr-only>Submit to Reddit</span></a></li></ul><style>ul.share-buttons{list-style:none;padding:0}ul.share-buttons li{display:inline}ul.share-buttons .sr-only{position:absolute;clip:rect(1px 1px 1px 1px);clip:rect(1px,1px,1px,1px);padding:0;border:0;height:1px;width:1px;overflow:hidden}</style><div class="prev-next-post pure-g"><div class=pure-u-1-24 style=text-align:left><a href=https://kpendolino.github.io/KendraCreates/2022/03/28/let_there_be_dark/><i class="fa fa-chevron-left"></i></a></div><div class=pure-u-10-24><nav class=prev><a href=https://kpendolino.github.io/KendraCreates/2022/03/28/let_there_be_dark/>Let There Be Dark</a></nav></div><div class=pure-u-2-24>&nbsp;</div><div class=pure-u-10-24><nav class=next><a href=https://kpendolino.github.io/KendraCreates/2022/04/02/pandas_dataframes/>Pandas DataFrames</a></nav></div><div class=pure-u-1-24 style=text-align:right><a href=https://kpendolino.github.io/KendraCreates/2022/04/02/pandas_dataframes/><i class="fa fa-chevron-right"></i></a></div></div></div></div></div><script src=https://kpendolino.github.io/KendraCreates/js/ui.js></script>
<script src=https://kpendolino.github.io/KendraCreates/js/menus.js></script>
<script src=https://kpendolino.github.io/KendraCreates/js/math-code.js></script>
<script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script></body></html>